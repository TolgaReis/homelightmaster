// src/mqtt/MqttService.js

import Mqtt from 'react-mqtt';

const mqttOptions = {
  clientId: 'your-client-id',
  host: 'mqtt-broker-url',
  port: 8083,
};

class MqttService {
  constructor() {
    this.client = new Mqtt(mqttOptions);
    this.client.onMessageArrived = this.handleMessage;
  }

  connect(topic, onConnected) {
    this.client.onConnected = () => {
      console.log('MQTT Bağlantısı Başarılı');
      this.client.subscribe(topic);
      onConnected();
    };

    this.client.connect();
  }

  disconnect() {
    this.client.disconnect();
  }

  handleMessage = (message) => {
    // Burada mesajı işleyebilirsiniz
    console.log('MQTT Mesajı:', message.payloadString);
  }
}

export default new MqttService(); // Bu satırı değiştirin
